{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../microsoft-teams-library-js/dist/MicrosoftTeams.min.js","webpack:///./src/utils.ts","webpack:///./src/app.ts","webpack:///./src/index.ts"],"names":[],"mappings":"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AA2C,QAAQ,YAAY,yFAAyF,IAAI,4BAA4B,qBAAqB,0DAA0D,kCAAkC,aAAa,mEAAmE,cAAc,4CAA4C,EAAE,iBAAiB,QAAQ,mCAAmC,+DAA+D,kCAAkC,aAAa,gGAAgG,oNAAoN,qCAAqC,KAAK,QAAQ,IAAI,kBAAkB,QAAQ,MAAM,qGAAqG,IAAI,4BAA4B,IAAI,uDAAuD,cAAc,4CAA4C,EAAE,uBAAuB,IAAI,oCAAoC,cAAc,4CAA4C,EAAE,+BAA+B,0HAA0H,+BAA+B,2HAA2H,yCAAyC,qCAAqC,oBAAoB,aAAa,0BAA0B,aAAa,iCAAiC,OAAO,4BAA4B,0EAA0E,uBAAuB,gCAAgC,IAAI,8BAA8B,QAAQ,uCAAuC,GAAG,GAAG,E;;;;;;;;;;ACA75V;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACnKoB;AACK;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AC3N8D;AAC/B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","!function(t,e){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)(\"object\"==typeof exports?exports:t)[i]=n[i]}}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(1);e.microsoftTeams=i.microsoftTeams},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t}),function(t){const e=\"1.3.6\";function n(t){let e=\"^\",n=t.split(\".\");for(let t=0;t<n.length;t++)e+=(t>0?\"[.]\":\"\")+n[t].replace(\"*\",\"[^/^.]+\");return e+=\"$\"}const i=function(t){let e=\"\";for(let i=0;i<t.length;i++)e+=(0===i?\"\":\"|\")+n(t[i]);return new RegExp(e)}([\"https://teams.microsoft.com\",\"https://teams.microsoft.us\",\"https://int.teams.microsoft.com\",\"https://devspaces.skype.com\",\"https://ssauth.skype.com\",\"http://dev.local\",\"https://msft.spoppe.com\",\"https://*.sharepoint.com\",\"https://*.sharepoint-df.com\",\"https://*.sharepointonline.com\",\"https://outlook.office.com\",\"https://outlook-sdf.office.com\"]),o={},s={settings:\"settings\",content:\"content\",authentication:\"authentication\",remove:\"remove\",task:\"task\"};let r;!function(t){let e,n,i,s;t.MenuItem=class{constructor(){this.enabled=!0}},function(t){t.dropDown=\"dropDown\",t.popOver=\"popOver\"}(e=t.MenuListType||(t.MenuListType={})),o.navBarMenuItemPress=function(t){n&&n(t)||(x(),L(c,\"handleNavBarMenuItemPress\",[t]))},o.actionMenuItemPress=function(t){i&&i(t)||(x(),L(c,\"handleActionMenuItemPress\",[t]))},o.setModuleView=function(t){s&&s(t)||(x(),L(c,\"viewConfigItemPress\",[t]))},t.setUpViews=function(t,e){x(),s=e,L(c,\"setUpViews\",[t])},t.setNavBarMenu=function(t,e){x(),n=e,L(c,\"setNavBarMenu\",[t])},t.showActionMenu=function(t,e){x(),i=e,L(c,\"showActionMenu\",[t])}}(r=t.menus||(t.menus={}));let a,c,u,l,f,d,h,p,g,m,y,v,b,w=!1,k=!1,T=[],C=[],M=0,I={},S=!1;function E(t){x(),p=t}function O(t){x(),g=t}function N(t){x(),m=t}function P(){x();let t=L(c,\"navigateBack\",[]);I[t]=(t=>{if(!t)throw new Error(\"Back navigation is not supported in the current client or context.\")})}function x(...t){if(!w)throw new Error(\"The library has not yet been initialized\");if(d&&t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===d){e=!0;break}if(!e)throw new Error(\"This call is not allowed in the '\"+d+\"' context\")}}function U(t){if(\"id\"in t.data){const e=t.data,n=I[e.id];n&&(n.apply(null,e.args),delete I[e.id])}else if(\"func\"in t.data){const e=t.data,n=o[e.func];n&&n.apply(this,e.args)}}function _(t){return t===c?T:t===l?C:[]}function j(t){return t===c?u:t===l?f:null}function A(t){let e=j(t),n=_(t);for(;t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function B(t,e){let n=a.setInterval(()=>{0===_(t).length&&(clearInterval(n),e())},100)}function L(t,e,n){let i=function(t,e){return{id:M++,func:t,args:e||[]}}(e,n);if(k)a&&a.nativeInterface&&a.nativeInterface.framelessPostMessage(JSON.stringify(i));else{let e=j(t);t&&e?t.postMessage(i,e):_(t).push(i)}return i.id}function D(t,e,n){let i=function(t,e){return{id:t,args:e||[]}}(e,n),o=j(t);t&&o&&t.postMessage(i,o)}o.themeChange=function(t){p&&p(t);l&&L(l,\"themeChange\",[t])},o.fullScreenChange=function(t){g&&g(t)},o.backButtonPress=function(){m&&m()||P()},t.initialize=function(t=window){if(w)return;w=!0;let n=t=>(function(t){if(!t||!t.data||\"object\"!=typeof t.data)return;let e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===a||n!==a.location.origin&&!i.test(n.toLowerCase())||(function(t,e){c&&t!==c?l&&t!==l||(l=t,f=e):(c=t,u=e),c&&c.closed&&(c=null,u=null),l&&l.closed&&(l=null,f=null),A(c),A(l)}(e,n),e===c?U(t):e===l&&function(t){if(\"id\"in t.data&&\"func\"in t.data){const e=t.data,n=o[e.func];if(n){let t=n.apply(this,e.args);t&&D(l,e.id,Array.isArray(t)?t:[t])}else{let t=L(c,e.func,e.args);I[t]=((...t)=>{l&&D(l,e.id,t)})}}}(t))})(t);(c=(a=t).parent!==a.self?a.parent:a.opener)?a.addEventListener(\"message\",n,!1):(k=!0,window.onNativeMessage=U);try{u=\"*\";let t=L(c,\"initialize\",[e]);I[t]=((t,e)=>{d=t,h=e})}finally{u=null}this._uninitialize=(()=>{d&&(E(null),O(null),N(null)),d===s.settings&&y.registerOnSaveHandler(null),d===s.remove&&y.registerOnRemoveHandler(null),k||a.removeEventListener(\"message\",n,!1),w=!1,c=null,u=null,T=[],l=null,f=null,C=[],M=0,I={},d=null,h=null,k=!1})},t._uninitialize=function(){},t.enablePrintCapability=function(){S||(S=!0,x(),document.addEventListener(\"keydown\",e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t.print(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))},t.print=function(){window.print()},t.getContext=function(t){x();let e=L(c,\"getContext\");I[e]=t},t.registerOnThemeChangeHandler=E,t.registerFullScreenHandler=O,t.registerBackButtonHandler=N,t.navigateBack=P,t.navigateCrossDomain=function(t){x(s.content,s.settings,s.remove,s.task);let e=L(c,\"navigateCrossDomain\",[t]);I[e]=(t=>{if(!t)throw new Error(\"Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.\")})},t.getTabInstances=function(t,e){x();let n=L(c,\"getTabInstances\",[e]);I[n]=t},t.getUserJoinedTeams=function(t,e){x();const n=L(c,\"getUserJoinedTeams\",[e]);I[n]=t},t.getMruTabInstances=function(t,e){x();let n=L(c,\"getMruTabInstances\",[e]);I[n]=t},t.shareDeepLink=function(t){x(s.content),L(c,\"shareDeepLink\",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])},t.openFilePreview=function(t){x(s.content);const e=[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId];L(c,\"openFilePreview\",e)},t.showNotification=function(t){x(s.content);const e=[t.message,t.isDownloadComplete];L(c,\"showNotification\",e)},t.uploadCustomApp=function(t){x();const e=L(c,\"uploadCustomApp\",[t]);I[e]=((t,e)=>{if(!t)throw new Error(e)})},t.navigateToTab=function(t){x();let e=L(c,\"navigateToTab\",[t]);I[e]=(t=>{if(!t)throw new Error(\"Invalid internalTabInstanceId and/or channelId were/was provided\")})},function(t){let e,n;o[\"settings.save\"]=function(t){let n=new i(t);e?e(n):n.notifySuccess()},o[\"settings.remove\"]=function(){let t=new r;n?n(t):t.notifySuccess()},t.setValidityState=function(t){x(s.settings,s.remove),L(c,\"settings.setValidityState\",[t])},t.getSettings=function(t){x(s.settings,s.remove);let e=L(c,\"settings.getSettings\");I[e]=t},t.setSettings=function(t){x(s.settings),L(c,\"settings.setSettings\",[t])},t.registerOnSaveHandler=function(t){x(s.settings),e=t},t.registerOnRemoveHandler=function(t){x(s.remove),n=t};class i{constructor(t){this.notified=!1,this.result=t||{}}notifySuccess(){this.ensureNotNotified(),L(c,\"settings.save.success\"),this.notified=!0}notifyFailure(t){this.ensureNotNotified(),L(c,\"settings.save.failure\",[t]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error(\"The SaveEvent may only notify success or failure once.\")}}class r{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),L(c,\"settings.remove.success\"),this.notified=!0}notifyFailure(t){this.ensureNotNotified(),L(c,\"settings.remove.failure\",[t]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error(\"The removeEvent may only notify success or failure once.\")}}}(y=t.settings||(t.settings={})),function(t){let e,n;function i(){r();try{l&&l.close()}finally{l=null,f=null}}function r(){n&&(clearInterval(n),n=0),delete o.initialize,delete o.navigateCrossDomain}function u(t){try{e&&e.failureCallback&&e.failureCallback(t)}finally{e=null,i()}}function d(t,e,n){if(t){let i=document.createElement(\"a\");i.href=decodeURIComponent(t),i.host&&i.host!==window.location.host&&\"outlook.office.com\"===i.host&&i.search.indexOf(\"client_type=Win32_Outlook\")>-1&&(e&&\"result\"===e&&(n&&(i.href=p(i.href,\"result\",n)),a.location.assign(p(i.href,\"authSuccess\",\"\"))),e&&\"reason\"===e&&(n&&(i.href=p(i.href,\"reason\",n)),a.location.assign(p(i.href,\"authFailure\",\"\"))))}}function p(t,e,n){let i=t.indexOf(\"#\"),o=-1===i?\"#\":t.substr(i);return o=o+\"&\"+e+(\"\"!==n?\"=\"+n:\"\"),(t=-1===i?t:t.substr(0,i))+o}o[\"authentication.authenticate.success\"]=function(t){try{e&&e.successCallback&&e.successCallback(t)}finally{e=null,i()}},o[\"authentication.authenticate.failure\"]=u,t.registerAuthenticationHandlers=function(t){e=t},t.authenticate=function(t){let d=void 0!==t?t:e;if(x(s.content,s.settings,s.remove,s.task),\"desktop\"===h){let t=document.createElement(\"a\");t.href=d.url;let e=L(c,\"authentication.authenticate\",[t.href,d.width,d.height]);I[e]=((t,e)=>{t?d.successCallback(e):d.failureCallback(e)})}else!function(t){e=t,i();let c=e.width||600,d=e.height||400;c=Math.min(c,a.outerWidth-400),d=Math.min(d,a.outerHeight-200);let p=document.createElement(\"a\");p.href=e.url;let g=void 0!==a.screenLeft?a.screenLeft:a.screenX,m=void 0!==a.screenTop?a.screenTop:a.screenY;g+=a.outerWidth/2-c/2,m+=a.outerHeight/2-d/2,(l=a.open(p.href,\"_blank\",\"toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top=\"+m+\", left=\"+g+\", width=\"+c+\", height=\"+d))?(r(),n=a.setInterval(()=>{if(!l||l.closed)u(\"CancelledByUser\");else{let t=f;try{f=\"*\",L(l,\"ping\")}finally{f=t}}},100),o.initialize=(()=>[s.authentication,h]),o.navigateCrossDomain=(t=>!1)):u(\"FailedToOpenWindow\")}(d)},t.getAuthToken=function(t){x();let e=L(c,\"authentication.getAuthToken\",[t.resources]);I[e]=((e,n)=>{e?t.successCallback(n):t.failureCallback(n)})},t.getUser=function(t){x();let e=L(c,\"authentication.getUser\");I[e]=((e,n)=>{e?t.successCallback(n):t.failureCallback(n)})},t.notifySuccess=function(t,e){d(e,\"result\",t),x(s.authentication),L(c,\"authentication.authenticate.success\",[t]),B(c,()=>setTimeout(()=>a.close(),200))},t.notifyFailure=function(t,e){d(e,\"reason\",t),x(s.authentication),L(c,\"authentication.authenticate.failure\",[t]),B(c,()=>setTimeout(()=>a.close(),200))}}(v=t.authentication||(t.authentication={})),t.sendCustomMessage=function(t,e){return x(),L(c,t,e)},function(t){t.startTask=function(t,e){x(s.content);let n=L(c,\"tasks.startTask\",[t]);I[n]=e},t.submitTask=function(t,e){x(s.content,s.task),L(c,\"tasks.completeTask\",[t,Array.isArray(e)?e:[e]])}}(b=t.tasks||(t.tasks={})),t.getChatMembers=function(t){x();const e=L(c,\"getChatMembers\");I[e]=t}}(e.microsoftTeams||(e.microsoftTeams={}))}])});","export let inputs = {};\r\nexport let container = document.createElement(\"div\");\r\ncontainer.classList.add(\"moduleContainer\");\r\nexport function addModule(config) {\r\n    var element = document.createElement(\"div\");\r\n    var button = document.createElement(\"button\");\r\n    button.appendChild(document.createTextNode(config.name));\r\n    button.id = \"button-\" + config.name;\r\n    element.appendChild(button);\r\n    element.appendChild(document.createElement(\"br\"));\r\n    if (config.inputs) {\r\n        element.appendChild(document.createElement(\"br\"));\r\n        for (var i = 0; i < config.inputs.length; i++) {\r\n            var label = document.createElement(\"label\");\r\n            label.appendChild(document.createTextNode(config.inputs[i].name + \":\"));\r\n            element.appendChild(label);\r\n            var input;\r\n            var valueGetter;\r\n            switch (config.inputs[i].type) {\r\n                case \"string\":\r\n                    input = document.createElement(\"input\");\r\n                    valueGetter = function () {\r\n                        return input.value;\r\n                    };\r\n                    break;\r\n                case \"boolean\":\r\n                    input = document.createElement(\"input\");\r\n                    input.type = \"checkbox\";\r\n                    valueGetter = function () {\r\n                        return input.checked;\r\n                    };\r\n                    break;\r\n                case \"object\":\r\n                    input = document.createElement(\"textarea\");\r\n                    valueGetter = function () {\r\n                        input.style.backgroundColor = \"\";\r\n                        try {\r\n                            return JSON.parse(input.value);\r\n                        }\r\n                        catch (e) {\r\n                            input.style.backgroundColor = \"red\";\r\n                            return null;\r\n                        }\r\n                    };\r\n                    break;\r\n            }\r\n            config.inputs[i].valueGetter = valueGetter;\r\n            input.id = \"input-\" + config.name + \"-\" + i;\r\n            element.appendChild(input);\r\n            inputs[input.id] = input;\r\n            element.appendChild(document.createElement(\"br\"));\r\n        }\r\n    }\r\n    if (config.hasOutput) {\r\n        var label = document.createElement(\"label\");\r\n        element.appendChild(document.createElement(\"br\"));\r\n        label.appendChild(document.createTextNode(\"Output:\"));\r\n        element.appendChild(label);\r\n        element.appendChild(document.createElement(\"br\"));\r\n        var textarea = document.createElement(\"textarea\");\r\n        textarea.id = \"textarea-\" + config.name;\r\n        element.appendChild(textarea);\r\n    }\r\n    container.appendChild(element);\r\n    button.addEventListener(\"click\", function () {\r\n        var args = [];\r\n        if (config.inputs) {\r\n            for (var i = 0; i < config.inputs.length; i++) {\r\n                var inputValue = config.inputs[i].valueGetter();\r\n                if (inputValue === null) {\r\n                    return;\r\n                }\r\n                args.push(inputValue);\r\n            }\r\n        }\r\n        if (config.hasOutput) {\r\n            args.push(function (result) {\r\n                if (typeof result !== \"string\") {\r\n                    result = JSON.stringify(result);\r\n                }\r\n                textarea.value = result;\r\n            });\r\n        }\r\n        config.action.apply(null, args);\r\n    });\r\n}\r\nexport function restoreState() {\r\n    var stateStr = localStorage.getItem(\"state\");\r\n    if (!stateStr) {\r\n        return;\r\n    }\r\n    var state = JSON.parse(stateStr);\r\n    for (var id in state) {\r\n        inputs[id].value = state[id];\r\n    }\r\n}\r\nexport function saveState() {\r\n    var state = {};\r\n    for (var id in inputs) {\r\n        state[id] = inputs[id].value;\r\n    }\r\n    localStorage.setItem(\"state\", JSON.stringify(state));\r\n}\r\nexport function downloadHandler() {\r\n    var input = document.querySelector('#image_uploads');\r\n    var preview = document.querySelector('.fileUploadPreview');\r\n    input.style.opacity = 0;\r\n    input.addEventListener('change', updateImageDisplay);\r\n    function updateImageDisplay() {\r\n        while (preview.firstChild) {\r\n            preview.removeChild(preview.firstChild);\r\n        }\r\n        var curFiles = input.files;\r\n        if (curFiles.length === 0) {\r\n            var para = document.createElement('p');\r\n            para.textContent = 'No files currently selected for upload';\r\n            preview.appendChild(para);\r\n        }\r\n        else {\r\n            var list = document.createElement('ol');\r\n            preview.appendChild(list);\r\n            for (var i = 0; i < curFiles.length; i++) {\r\n                var listItem = document.createElement('li');\r\n                var para = document.createElement('p');\r\n                if (validFileType(curFiles[i])) {\r\n                    para.textContent = 'File name ' + curFiles[i].name + ', file size ' + returnFileSize(curFiles[i].size) + '.';\r\n                    var image = document.createElement('img');\r\n                    image.src = window.URL.createObjectURL(curFiles[i]);\r\n                    listItem.appendChild(image);\r\n                    listItem.appendChild(para);\r\n                }\r\n                else {\r\n                    para.textContent = 'File name ' + curFiles[i].name + ': Not a valid file type. Update your selection.';\r\n                    listItem.appendChild(para);\r\n                }\r\n                list.appendChild(listItem);\r\n            }\r\n        }\r\n    }\r\n    var fileTypes = [\r\n        'image/jpeg',\r\n        'image/pjpeg',\r\n        'image/png'\r\n    ];\r\n    function validFileType(file) {\r\n        for (var i = 0; i < fileTypes.length; i++) {\r\n            if (file.type === fileTypes[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function returnFileSize(number) {\r\n        if (number < 1024) {\r\n            return number + 'bytes';\r\n        }\r\n        else if (number >= 1024 && number < 1048576) {\r\n            return (number / 1024).toFixed(1) + 'KB';\r\n        }\r\n        else if (number >= 1048576) {\r\n            return (number / 1048576).toFixed(1) + 'MB';\r\n        }\r\n    }\r\n}\r\n","import { addModule } from \"./utils\";\r\nimport { microsoftTeams } from '@microsoft/teams-js';\r\nexport const initializeAppModules = () => {\r\n    addModule({\r\n        name: \"initialize\",\r\n        action: function () {\r\n            microsoftTeams.initialize();\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getContext\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.getContext(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"navigateCrossDomain\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"url\"\r\n            },],\r\n        action: function (url) {\r\n            microsoftTeams.navigateCrossDomain(url);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"registerOnThemeChangeHandler\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.registerOnThemeChangeHandler(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"shareDeepLink\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"deepLinkParameters\"\r\n            },],\r\n        action: function (deepLinkParameters) {\r\n            microsoftTeams.shareDeepLink(deepLinkParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.authenticate\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"url\"\r\n            },],\r\n        hasOutput: true,\r\n        action: function (url, output) {\r\n            microsoftTeams.authentication.authenticate({\r\n                url: url,\r\n                successCallback: function (result) {\r\n                    output(\"Success:\" + result);\r\n                },\r\n                failureCallback: function (reason) {\r\n                    output(\"Failure:\" + reason);\r\n                    MessageEvent;\r\n                },\r\n            });\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.notifyFailure\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"reason\"\r\n            },],\r\n        action: function (reason) {\r\n            microsoftTeams.authentication.notifyFailure(reason);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.notifySuccess\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"result\"\r\n            },],\r\n        action: function (result) {\r\n            microsoftTeams.authentication.notifySuccess(result);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.getSettings\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.settings.getSettings(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.settings.registerOnSaveHandler(function (saveEvent) {\r\n                window.saveEvent = saveEvent;\r\n                output(\"SaveEvent recieved\");\r\n            });\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler.notifyFailure\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"reason\"\r\n            }],\r\n        action: function (reason) {\r\n            window.saveEvent && window.saveEvent.notifyFailure(reason);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler.notifySuccess\",\r\n        action: function () {\r\n            window.saveEvent && window.saveEvent.notifySuccess();\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.setSettings\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"settings\"\r\n            }],\r\n        action: function (settings) {\r\n            microsoftTeams.settings.setSettings(settings);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.setValidityState\",\r\n        inputs: [{\r\n                type: \"boolean\",\r\n                name: \"validityState\"\r\n            }],\r\n        action: function (validityState) {\r\n            microsoftTeams.settings.setValidityState(validityState);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"openFilePreview\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"filePreviewParameters\"\r\n            }],\r\n        action: function (filePreviewParameters) {\r\n            microsoftTeams.openFilePreview(filePreviewParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"task.submitTask\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"result\"\r\n            },\r\n            {\r\n                type: \"string\",\r\n                name: \"appId\"\r\n            },\r\n        ],\r\n        action: function (result, appId) {\r\n            microsoftTeams.tasks.submitTask(result, appId);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"tasks.startTask\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"taskInfo\"\r\n            },],\r\n        action: function (taskInfo) {\r\n            microsoftTeams.tasks.startTask(taskInfo);\r\n        }\r\n    });\r\n    /* addModule({\r\n      name: \"downloadFile\",\r\n      inputs: [{\r\n        type: \"object\",\r\n        name: \"fileDownloadParameters\"\r\n      }, ],\r\n      action: function (fileDownloadParameters) {\r\n        if(microsoftTeams.downloadFile) {\r\n            microsoftTeams.downloadFile(fileDownloadParameters);\r\n        }\r\n      }\r\n    });\r\n\r\n    */\r\n    addModule({\r\n        name: \"downloadFile ShowNotificationOnly\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"showNotificationParameters\"\r\n            },],\r\n        action: function (showNotificationParameters) {\r\n            microsoftTeams.showNotification(showNotificationParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getAuthToken\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"getAuthTokenParameters\"\r\n            },],\r\n        action: function (getAuthTokenParameters) {\r\n            microsoftTeams.authentication.getAuthToken(getAuthTokenParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getChatMembers\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.getChatMembers(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getUserJoinedTeams\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.getUserJoinedTeams(output);\r\n        }\r\n    });\r\n};\r\n","import { container, restoreState, saveState, downloadHandler } from './utils';\r\nimport { initializeAppModules } from './app';\r\n(function () {\r\n    initializeAppModules();\r\n    document.body.appendChild(container);\r\n    // Give the DOM a chance to update from the appendChild above\r\n    setTimeout(restoreState, 0);\r\n    window.addEventListener(\"beforeunload\", saveState);\r\n    window.addEventListener(\"load\", downloadHandler);\r\n})();\r\n"],"sourceRoot":""}