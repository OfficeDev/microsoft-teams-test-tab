{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@microsoft/teams-js/dist/MicrosoftTeams.min.js","webpack:///./src/utils.ts","webpack:///./src/app.ts","webpack:///./src/index.ts"],"names":[],"mappings":"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BAA2B,mCAAmC,UAAU,gBAAgB,kGAAkG,6BAA6B,iBAAiB,MAAM,EAAE,gBAAgB,kGAAkG,6BAA6B,iBAAiB,MAAM,EAAE,cAAc,IAAI,2CAA2C,QAAQ,YAAY,cAAc,IAAI,2CAA2C,QAAQ,YAAY,kBAAkB,MAAM,kCAAkC,4VAA4V,kBAAkB,8CAA8C,gEAAgE,QAAQ,2MAA2M,0CAA0C,yBAAyB,OAAO,aAAa,gBAAgB,aAAa,iCAAiC,QAAQ,gBAAgB,yEAAyE,6BAA6B,wBAAwB,sBAAsB,SAAS,KAAK,E;;;;;;;;;;ACA18U;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACnKoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;ACnN8D;AAC/B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","!function(t,e){\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?module.exports=e():t.microsoftTeams=e()}(this,function(){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});var t;return function(t){\"use strict\";function e(t){for(var e=\"^\",n=t.split(\".\"),i=0;i<n.length;i++)e+=(i>0?\"[.]\":\"\")+n[i].replace(\"*\",\"[^/^.]+\");return e+=\"$\"}function n(t){for(var n=\"\",i=0;i<t.length;i++)n+=(0===i?\"\":\"|\")+e(t[i]);return new RegExp(n)}function i(){if(!Z){Z=!0,J=this._window||window;var t=function(t){return E(t)};K=J.parent!==J.self?J.parent:J.opener,K?J.addEventListener(\"message\",t,!1):(tt=!0,window.onNativeMessage=S);try{X=\"*\";var e=O(K,\"initialize\",[z]);ot[e]=function(t,e){q=t,G=e}}finally{X=null}this._uninitialize=function(){q&&(s(null),c(null),l(null)),q===j.settings&&ut.registerOnSaveHandler(null),q===j.remove&&ut.registerOnRemoveHandler(null),tt||J.removeEventListener(\"message\",t,!1),Z=!1,K=null,X=null,et=[],Y=null,$=null,nt=[],it=0,ot={},q=null,G=null,tt=!1}}}function o(){at||(at=!0,I(),document.addEventListener(\"keydown\",function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t.print(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}function a(){window.print()}function r(t){I();var e=O(K,\"getContext\");ot[e]=t}function s(t){I(),Q=t}function u(t){Q&&Q(t),Y&&O(Y,\"themeChange\",[t])}function c(t){I(),rt=t}function f(t){rt&&rt(t)}function l(t){I(),st=t}function h(){st&&st()||d()}function d(){I();var t=O(K,\"navigateBack\",[]);ot[t]=function(t){if(!t)throw new Error(\"Back navigation is not supported in the current client or context.\")}}function v(t){I(j.content,j.settings,j.remove,j.task);var e=O(K,\"navigateCrossDomain\",[t]);ot[e]=function(t){if(!t)throw new Error(\"Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.\")}}function g(t,e){I();var n=O(K,\"getTabInstances\",[e]);ot[n]=t}function p(t,e){I();var n=O(K,\"getUserJoinedTeams\",[e]);ot[n]=t}function m(t,e){I();var n=O(K,\"getMruTabInstances\",[e]);ot[n]=t}function y(t){I(j.content),O(K,\"shareDeepLink\",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])}function w(t){I(j.content);var e=[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId];O(K,\"openFilePreview\",e)}function b(t){I(j.content);var e=[t.objectUrl,t.title];O(K,\"downloadFile\",e)}function k(t){I(j.content);var e=[t.message,t.isDownloadComplete];O(K,\"showNotification\",e)}function C(t){I();var e=O(K,\"uploadCustomApp\",[t]);ot[e]=function(t,e){if(!t)throw new Error(e)}}function T(t){I();var e=O(K,\"navigateToTab\",[t]);ot[e]=function(t){if(!t)throw new Error(\"Invalid internalTabInstanceId and/or channelId were/was provided\")}}function I(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!Z)throw new Error(\"The library has not yet been initialized\");if(q&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===q){n=!0;break}if(!n)throw new Error(\"This call is not allowed in the '\"+q+\"' context\")}}function E(t){if(t&&t.data&&\"object\"==typeof t.data){var e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===J||n!==J.location.origin&&!V.test(n.toLowerCase())||(M(e,n),e===K?S(t):e===Y&&N(t))}}function M(t,e){K&&t!==K?Y&&t!==Y||(Y=t,$=e):(K=t,X=e),K&&K.closed&&(K=null,X=null),Y&&Y.closed&&(Y=null,$=null),B(K),B(Y)}function S(t){if(\"id\"in t.data){var e=t.data,n=ot[e.id];n&&(n.apply(null,e.args),delete ot[e.id])}else if(\"func\"in t.data){var e=t.data,i=_[e.func];i&&i.apply(this,e.args)}}function N(t){if(\"id\"in t.data&&\"func\"in t.data){var e=t.data,n=_[e.func];if(n){var i=n.apply(this,e.args);i&&F(Y,e.id,Array.isArray(i)?i:[i])}else{var o=O(K,e.func,e.args);ot[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Y&&F(Y,e.id,t)}}}}function U(t){return t===K?et:t===Y?nt:[]}function A(t){return t===K?X:t===Y?$:null}function B(t){for(var e=A(t),n=U(t);t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function L(t,e){var n=J.setInterval(function(){0===U(t).length&&(clearInterval(n),e())},100)}function O(t,e,n){var i=D(e,n);if(tt)J&&J.nativeInterface&&J.nativeInterface.framelessPostMessage(JSON.stringify(i));else{var o=A(t);t&&o?t.postMessage(i,o):U(t).push(i)}return i.id}function P(t,e){return I(),O(K,t,e)}function F(t,e,n){var i=H(e,n),o=A(t);t&&o&&t.postMessage(i,o)}function D(t,e){return{id:it++,func:t,args:e||[]}}function H(t,e){return{id:t,args:e||[]}}function x(t){I();var e=O(K,\"getChatMembers\");ot[e]=t}var W,z=\"1.3.6\",R=[\"https://teams.microsoft.com\",\"https://teams.microsoft.us\",\"https://int.teams.microsoft.com\",\"https://devspaces.skype.com\",\"https://ssauth.skype.com\",\"http://dev.local\",\"https://msft.spoppe.com\",\"https://*.sharepoint.com\",\"https://*.sharepoint-df.com\",\"https://*.sharepointonline.com\",\"https://outlook.office.com\",\"https://outlook-sdf.office.com\"],V=n(R),_={},j={settings:\"settings\",content:\"content\",authentication:\"authentication\",remove:\"remove\",task:\"task\"};!function(t){function e(t,e){I(),l=e,O(K,\"setUpViews\",[t])}function n(t){l&&l(t)||(I(),O(K,\"viewConfigItemPress\",[t]))}function i(t,e){I(),c=e,O(K,\"setNavBarMenu\",[t])}function o(t){c&&c(t)||(I(),O(K,\"handleNavBarMenuItemPress\",[t]))}function a(t,e){I(),f=e,O(K,\"showActionMenu\",[t])}function r(t){f&&f(t)||(I(),O(K,\"handleActionMenuItemPress\",[t]))}var s=function(){function t(){this.enabled=!0}return t}();t.MenuItem=s;var u;!function(t){t.dropDown=\"dropDown\",t.popOver=\"popOver\"}(u=t.MenuListType||(t.MenuListType={}));var c;_.navBarMenuItemPress=o;var f;_.actionMenuItemPress=r;var l;_.setModuleView=n,t.setUpViews=e,t.setNavBarMenu=i,t.showActionMenu=a}(W=t.menus||(t.menus={}));var J,K,X,Y,$,q,G,Q,Z=!1,tt=!1,et=[],nt=[],it=0,ot={},at=!1;_.themeChange=u;var rt;_.fullScreenChange=f;var st;_.backButtonPress=h,t.initialize=i,t.enablePrintCapability=o,t.print=a,t.getContext=r,t.registerOnThemeChangeHandler=s,t.registerFullScreenHandler=c,t.registerBackButtonHandler=l,t.navigateBack=d,t.navigateCrossDomain=v,t.getTabInstances=g,t.getUserJoinedTeams=p,t.getMruTabInstances=m,t.shareDeepLink=y,t.openFilePreview=w,t.downloadFile=b,t.showNotification=k,t.uploadCustomApp=C,t.navigateToTab=T;var ut;!function(t){function e(t){I(j.settings,j.remove),O(K,\"settings.setValidityState\",[t])}function n(t){I(j.settings,j.remove);var e=O(K,\"settings.getSettings\");ot[e]=t}function i(t){I(j.settings),O(K,\"settings.setSettings\",[t])}function o(t){I(j.settings),u=t}function a(t){I(j.remove),c=t}function r(t){var e=new f(t);u?u(e):e.notifySuccess()}function s(){var t=new l;c?c(t):t.notifySuccess()}var u,c;_[\"settings.save\"]=r,_[\"settings.remove\"]=s,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=a;var f=function(){function t(t){this.notified=!1,this.result=t?t:{}}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),O(K,\"settings.save.success\"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),O(K,\"settings.save.failure\",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error(\"The SaveEvent may only notify success or failure once.\")},t}(),l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),O(K,\"settings.remove.success\"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),O(K,\"settings.remove.failure\",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error(\"The removeEvent may only notify success or failure once.\")},t}()}(ut=t.settings||(t.settings={}));var ct;!function(t){function e(t){g=t}function n(t){var e=void 0!==t?t:g;if(I(j.content,j.settings,j.remove,j.task),\"desktop\"===G){var n=document.createElement(\"a\");n.href=e.url;var i=O(K,\"authentication.authenticate\",[n.href,e.width,e.height]);ot[i]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}}else r(e)}function i(t){I();var e=O(K,\"authentication.getAuthToken\",[t.resources]);ot[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function o(t){I();var e=O(K,\"authentication.getUser\");ot[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function a(){s();try{Y&&Y.close()}finally{Y=null,$=null}}function r(t){g=t,a();var e=g.width||600,n=g.height||400;e=Math.min(e,J.outerWidth-400),n=Math.min(n,J.outerHeight-200);var i=document.createElement(\"a\");i.href=g.url;var o=\"undefined\"!=typeof J.screenLeft?J.screenLeft:J.screenX,r=\"undefined\"!=typeof J.screenTop?J.screenTop:J.screenY;o+=J.outerWidth/2-e/2,r+=J.outerHeight/2-n/2,Y=J.open(i.href,\"_blank\",\"toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top=\"+r+\", left=\"+o+\", width=\"+e+\", height=\"+n),Y?u():h(\"FailedToOpenWindow\")}function s(){p&&(clearInterval(p),p=0),delete _.initialize,delete _.navigateCrossDomain}function u(){s(),p=J.setInterval(function(){if(!Y||Y.closed)h(\"CancelledByUser\");else{var t=$;try{$=\"*\",O(Y,\"ping\")}finally{$=t}}},100),_.initialize=function(){return[j.authentication,G]},_.navigateCrossDomain=function(t){return!1}}function c(t,e){d(e,\"result\",t),I(j.authentication),O(K,\"authentication.authenticate.success\",[t]),L(K,function(){return setTimeout(function(){return J.close()},200)})}function f(t,e){d(e,\"reason\",t),I(j.authentication),O(K,\"authentication.authenticate.failure\",[t]),L(K,function(){return setTimeout(function(){return J.close()},200)})}function l(t){try{g&&g.successCallback&&g.successCallback(t)}finally{g=null,a()}}function h(t){try{g&&g.failureCallback&&g.failureCallback(t)}finally{g=null,a()}}function d(t,e,n){if(t){var i=document.createElement(\"a\");i.href=decodeURIComponent(t),i.host&&i.host!==window.location.host&&\"outlook.office.com\"===i.host&&i.search.indexOf(\"client_type=Win32_Outlook\")>-1&&(e&&\"result\"===e&&(n&&(i.href=v(i.href,\"result\",n)),J.location.assign(v(i.href,\"authSuccess\",\"\"))),e&&\"reason\"===e&&(n&&(i.href=v(i.href,\"reason\",n)),J.location.assign(v(i.href,\"authFailure\",\"\"))))}}function v(t,e,n){var i=t.indexOf(\"#\"),o=i===-1?\"#\":t.substr(i);return o=o+\"&\"+e+(\"\"!==n?\"=\"+n:\"\"),t=i===-1?t:t.substr(0,i),t+o}var g,p;_[\"authentication.authenticate.success\"]=l,_[\"authentication.authenticate.failure\"]=h,t.registerAuthenticationHandlers=e,t.authenticate=n,t.getAuthToken=i,t.getUser=o,t.notifySuccess=c,t.notifyFailure=f}(ct=t.authentication||(t.authentication={})),t.sendCustomMessage=P;var ft;!function(t){function e(t,e){I(j.content);var n=O(K,\"tasks.startTask\",[t]);ot[n]=e}function n(t,e){I(j.content,j.task),O(K,\"tasks.completeTask\",[t,Array.isArray(e)?e:[e]])}t.startTask=e,t.submitTask=n}(ft=t.tasks||(t.tasks={})),t.getChatMembers=x}(t||(t={})),t});","export var inputs = {};\r\nexport var container = document.createElement(\"div\");\r\ncontainer.classList.add(\"moduleContainer\");\r\nexport function addModule(config) {\r\n    var element = document.createElement(\"div\");\r\n    var button = document.createElement(\"button\");\r\n    button.appendChild(document.createTextNode(config.name));\r\n    button.id = \"button-\" + config.name;\r\n    element.appendChild(button);\r\n    element.appendChild(document.createElement(\"br\"));\r\n    if (config.inputs) {\r\n        element.appendChild(document.createElement(\"br\"));\r\n        for (var i = 0; i < config.inputs.length; i++) {\r\n            var label = document.createElement(\"label\");\r\n            label.appendChild(document.createTextNode(config.inputs[i].name + \":\"));\r\n            element.appendChild(label);\r\n            var input;\r\n            var valueGetter;\r\n            switch (config.inputs[i].type) {\r\n                case \"string\":\r\n                    input = document.createElement(\"input\");\r\n                    valueGetter = function () {\r\n                        return input.value;\r\n                    };\r\n                    break;\r\n                case \"boolean\":\r\n                    input = document.createElement(\"input\");\r\n                    input.type = \"checkbox\";\r\n                    valueGetter = function () {\r\n                        return input.checked;\r\n                    };\r\n                    break;\r\n                case \"object\":\r\n                    input = document.createElement(\"textarea\");\r\n                    valueGetter = function () {\r\n                        input.style.backgroundColor = \"\";\r\n                        try {\r\n                            return JSON.parse(input.value);\r\n                        }\r\n                        catch (e) {\r\n                            input.style.backgroundColor = \"red\";\r\n                            return null;\r\n                        }\r\n                    };\r\n                    break;\r\n            }\r\n            config.inputs[i].valueGetter = valueGetter;\r\n            input.id = \"input-\" + config.name + \"-\" + i;\r\n            element.appendChild(input);\r\n            inputs[input.id] = input;\r\n            element.appendChild(document.createElement(\"br\"));\r\n        }\r\n    }\r\n    if (config.hasOutput) {\r\n        var label = document.createElement(\"label\");\r\n        element.appendChild(document.createElement(\"br\"));\r\n        label.appendChild(document.createTextNode(\"Output:\"));\r\n        element.appendChild(label);\r\n        element.appendChild(document.createElement(\"br\"));\r\n        var textarea = document.createElement(\"textarea\");\r\n        textarea.id = \"textarea-\" + config.name;\r\n        element.appendChild(textarea);\r\n    }\r\n    container.appendChild(element);\r\n    button.addEventListener(\"click\", function () {\r\n        var args = [];\r\n        if (config.inputs) {\r\n            for (var i = 0; i < config.inputs.length; i++) {\r\n                var inputValue = config.inputs[i].valueGetter();\r\n                if (inputValue === null) {\r\n                    return;\r\n                }\r\n                args.push(inputValue);\r\n            }\r\n        }\r\n        if (config.hasOutput) {\r\n            args.push(function (result) {\r\n                if (typeof result !== \"string\") {\r\n                    result = JSON.stringify(result);\r\n                }\r\n                textarea.value = result;\r\n            });\r\n        }\r\n        config.action.apply(null, args);\r\n    });\r\n}\r\nexport function restoreState() {\r\n    var stateStr = localStorage.getItem(\"state\");\r\n    if (!stateStr) {\r\n        return;\r\n    }\r\n    var state = JSON.parse(stateStr);\r\n    for (var id in state) {\r\n        inputs[id].value = state[id];\r\n    }\r\n}\r\nexport function saveState() {\r\n    var state = {};\r\n    for (var id in inputs) {\r\n        state[id] = inputs[id].value;\r\n    }\r\n    localStorage.setItem(\"state\", JSON.stringify(state));\r\n}\r\nexport function downloadHandler() {\r\n    var input = document.querySelector('#image_uploads');\r\n    var preview = document.querySelector('.fileUploadPreview');\r\n    input.style.opacity = 0;\r\n    input.addEventListener('change', updateImageDisplay);\r\n    function updateImageDisplay() {\r\n        while (preview.firstChild) {\r\n            preview.removeChild(preview.firstChild);\r\n        }\r\n        var curFiles = input.files;\r\n        if (curFiles.length === 0) {\r\n            var para = document.createElement('p');\r\n            para.textContent = 'No files currently selected for upload';\r\n            preview.appendChild(para);\r\n        }\r\n        else {\r\n            var list = document.createElement('ol');\r\n            preview.appendChild(list);\r\n            for (var i = 0; i < curFiles.length; i++) {\r\n                var listItem = document.createElement('li');\r\n                var para = document.createElement('p');\r\n                if (validFileType(curFiles[i])) {\r\n                    para.textContent = 'File name ' + curFiles[i].name + ', file size ' + returnFileSize(curFiles[i].size) + '.';\r\n                    var image = document.createElement('img');\r\n                    image.src = window.URL.createObjectURL(curFiles[i]);\r\n                    listItem.appendChild(image);\r\n                    listItem.appendChild(para);\r\n                }\r\n                else {\r\n                    para.textContent = 'File name ' + curFiles[i].name + ': Not a valid file type. Update your selection.';\r\n                    listItem.appendChild(para);\r\n                }\r\n                list.appendChild(listItem);\r\n            }\r\n        }\r\n    }\r\n    var fileTypes = [\r\n        'image/jpeg',\r\n        'image/pjpeg',\r\n        'image/png'\r\n    ];\r\n    function validFileType(file) {\r\n        for (var i = 0; i < fileTypes.length; i++) {\r\n            if (file.type === fileTypes[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function returnFileSize(number) {\r\n        if (number < 1024) {\r\n            return number + 'bytes';\r\n        }\r\n        else if (number >= 1024 && number < 1048576) {\r\n            return (number / 1024).toFixed(1) + 'KB';\r\n        }\r\n        else if (number >= 1048576) {\r\n            return (number / 1048576).toFixed(1) + 'MB';\r\n        }\r\n    }\r\n}\r\n","import { addModule } from \"./utils\";\r\nimport * as microsoftTeams from '@microsoft/teams-js';\r\nexport var initializeAppModules = function () {\r\n    addModule({\r\n        name: \"initialize\",\r\n        action: function () {\r\n            microsoftTeams.initialize();\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getContext\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.getContext(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"navigateCrossDomain\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"url\"\r\n            },],\r\n        action: function (url) {\r\n            microsoftTeams.navigateCrossDomain(url);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"registerOnThemeChangeHandler\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.registerOnThemeChangeHandler(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"shareDeepLink\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"deepLinkParameters\"\r\n            },],\r\n        action: function (deepLinkParameters) {\r\n            microsoftTeams.shareDeepLink(deepLinkParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.authenticate\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"url\"\r\n            },],\r\n        hasOutput: true,\r\n        action: function (url, output) {\r\n            microsoftTeams.authentication.authenticate({\r\n                url: url,\r\n                successCallback: function (result) {\r\n                    output(\"Success:\" + result);\r\n                },\r\n                failureCallback: function (reason) {\r\n                    output(\"Failure:\" + reason);\r\n                },\r\n            });\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.notifyFailure\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"reason\"\r\n            },],\r\n        action: function (reason) {\r\n            microsoftTeams.authentication.notifyFailure(reason);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"authentication.notifySuccess\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"result\"\r\n            },],\r\n        action: function (result) {\r\n            microsoftTeams.authentication.notifySuccess(result);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.getSettings\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.settings.getSettings(output);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.settings.registerOnSaveHandler(function (saveEvent) {\r\n                window.saveEvent = saveEvent;\r\n                output(\"SaveEvent recieved\");\r\n            });\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler.notifyFailure\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"reason\"\r\n            }],\r\n        action: function (reason) {\r\n            window.saveEvent && window.saveEvent.notifyFailure(reason);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.registerOnSaveHandler.notifySuccess\",\r\n        action: function () {\r\n            window.saveEvent && window.saveEvent.notifySuccess();\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.setSettings\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"settings\"\r\n            }],\r\n        action: function (settings) {\r\n            microsoftTeams.settings.setSettings(settings);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"settings.setValidityState\",\r\n        inputs: [{\r\n                type: \"boolean\",\r\n                name: \"validityState\"\r\n            }],\r\n        action: function (validityState) {\r\n            microsoftTeams.settings.setValidityState(validityState);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"openFilePreview\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"filePreviewParameters\"\r\n            }],\r\n        action: function (filePreviewParameters) {\r\n            microsoftTeams.openFilePreview(filePreviewParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"task.submitTask\",\r\n        inputs: [{\r\n                type: \"string\",\r\n                name: \"result\"\r\n            },\r\n            {\r\n                type: \"string\",\r\n                name: \"appId\"\r\n            },\r\n        ],\r\n        action: function (result, appId) {\r\n            microsoftTeams.tasks.submitTask(result, appId);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"tasks.startTask\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"taskInfo\"\r\n            },],\r\n        action: function (taskInfo) {\r\n            microsoftTeams.tasks.startTask(taskInfo);\r\n        }\r\n    });\r\n    /* addModule({\r\n      name: \"downloadFile\",\r\n      inputs: [{\r\n        type: \"object\",\r\n        name: \"fileDownloadParameters\"\r\n      }, ],\r\n      action: function (fileDownloadParameters) {\r\n        if(microsoftTeams.downloadFile) {\r\n            microsoftTeams.downloadFile(fileDownloadParameters);\r\n        }\r\n      }\r\n    });\r\n\r\n    */\r\n    addModule({\r\n        name: \"downloadFile ShowNotificationOnly\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"showNotificationParameters\"\r\n            },],\r\n        action: function (showNotificationParameters) {\r\n            microsoftTeams.showNotification(showNotificationParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getAuthToken\",\r\n        inputs: [{\r\n                type: \"object\",\r\n                name: \"getAuthTokenParameters\"\r\n            },],\r\n        action: function (getAuthTokenParameters) {\r\n            microsoftTeams.authentication.getAuthToken(getAuthTokenParameters);\r\n        }\r\n    });\r\n    addModule({\r\n        name: \"getChatMembers\",\r\n        hasOutput: true,\r\n        action: function (output) {\r\n            microsoftTeams.getChatMembers(output);\r\n        }\r\n    });\r\n};\r\n","import { container, restoreState, saveState, downloadHandler } from './utils';\r\nimport { initializeAppModules } from './app';\r\n(function () {\r\n    initializeAppModules();\r\n    document.body.appendChild(container);\r\n    // Give the DOM a chance to update from the appendChild above\r\n    setTimeout(restoreState, 0);\r\n    window.addEventListener(\"beforeunload\", saveState);\r\n    window.addEventListener(\"load\", downloadHandler);\r\n})();\r\n"],"sourceRoot":""}